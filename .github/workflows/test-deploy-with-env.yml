name: Deploy with environment

on:
  workflow_dispatch:
  push:
#  pull_request:
#    branches:
#      - dev
#      - release/**
#      - hotfix/**

jobs:
  environment:
    uses: test-org-fanna/.github/.github/workflows/determine-environment.yml@main
#    outputs:
#      environment: ${{ steps.retrieve-environment.outputs.env_name }}

  deploy:
    needs: environment
    uses: test-org-fanna/.github/.github/workflows/deploy-docker-compose.yml@main
    environment: ${{ needs.environment.outputs.environment }}
    with:
      host: ${{ vars.HOST }}
    secrets:
      key: ${{ secrets.SSH_PRIVATE_KEY }}